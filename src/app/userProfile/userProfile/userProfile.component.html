<ng-container *ngIf="data$ | async as data">
  <div *ngIf="data.userProfile">
    <!-- Header -->
    <section class="bg-gray-50 border-b">
      <div class="container mx-auto px-4 py-8">
        <div class="max-w-3xl mx-auto flex items-center gap-4">
          <p-avatar
            [image]="getUserImage(data.userProfile)"
            shape="circle"
            size="xlarge"
          >
          </p-avatar>

          <div class="min-w-0">
            <h2 class="text-xl md:text-2xl font-semibold truncate">
              {{ data.userProfile.username }}
            </h2>
            <p class="text-gray-600 text-sm md:text-base break-words">
              {{ data.userProfile.bio || " " }}
            </p>
          </div>

          <div class="ml-auto">
            <!-- Show Edit for owner; otherwise show a placeholder Follow button -->
            <a
              *ngIf="data.isCurrentUserProfile; else followBtn"
              routerLink="/settings"
              pButton
              icon="pi pi-cog"
              label="Edit Profile"
              class="p-button-outlined p-button-secondary p-button-sm"
            >
            </a>

            <ng-template #followBtn>
              <button
                pButton
                label="Follow"
                icon="pi pi-user-plus"
                class="p-button-sm"
                disabled
              ></button>
            </ng-template>
          </div>
        </div>
      </div>
    </section>

    <!-- Tabs + Feed -->
    <div class="container mx-auto px-4 py-6">
      <div class="max-w-3xl mx-auto">
        <p-tabMenu
          [model]="items"
          [activeItem]="activeItem || items[0]"
          class="overflow-x-auto whitespace-nowrap text-sm md:text-base mb-4"
        >
        </p-tabMenu>

        <mc-feed [apiUrl]="getApiUrl()"></mc-feed>
      </div>
    </div>
  </div>
</ng-container>
