<ng-container *ngIf="data$ | async as data">
  <div *ngIf="data.userProfile">
    <!-- Header -->
    <section class="bg-gray-50 border-b dark:bg-neutral-900/40">
      <div class="container mx-auto px-4 py-8">
        <div class="max-w-3xl mx-auto flex items-center gap-4">
          <p-avatar
            [image]="getUserImage(data.userProfile.image)"
            shape="circle"
            size="xlarge"
          >
          </p-avatar>

          <div class="min-w-0">
            <h2 class="text-xl md:text-2xl font-semibold truncate">
              {{ data.userProfile.username }}
            </h2>
            <p
              class="text-gray-600 text-sm md:text-base break-words dark:text-gray-300"
            >
              {{ data.userProfile.bio || " " }}
            </p>
          </div>

          <div class="ml-auto">
            <a
              *ngIf="data.isCurrentUserProfile; else followToggle"
              routerLink="/settings"
              pButton
              icon="pi pi-cog"
              label="Edit Profile"
              class="p-button-outlined p-button-secondary p-button-sm"
            >
            </a>

            <ng-template #followToggle>
              <mc-follow-button
                [username]="data.userProfile.username"
                [following]="data.userProfile.following"
              >
              </mc-follow-button>
            </ng-template>
          </div>
        </div>
      </div>
    </section>

    <!-- Tabs + Feed -->
    <div class="container mx-auto px-4 py-6">
      <div class="max-w-3xl mx-auto">
        <p-tabMenu
          [model]="items"
          [activeItem]="activeItem || items[0]"
          class="overflow-x-auto whitespace-nowrap text-sm md:text-base mb-4"
        >
        </p-tabMenu>

        <mc-feed [apiUrl]="getApiUrl()"></mc-feed>
      </div>
    </div>
  </div>
</ng-container>
